function [xs]=sgsmooth(x,p);
% smoothing 
% e.g. [xs]=sgsmooth(x,p);
% x: data
% p: number of points

p=(p-1)/2;
[sl]=sglist;
[m n]=size(x);
P=p-1;
c=sl(13-p:13+p,P);
W=sum(c);
c=c';
c=repmat(c,m,1);
xs=zeros(m,n);

for i=p+1:n-p
X=x(:,i-p:i+p);
xs(:,i)=(sum((X.*c)'))'/W;
end
xs(:,1:p)=repmat(xs(:,p+1),1,p);
xs(:,n-p+1:n)=repmat(xs(:,n-p),1,p);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function [sl]=sglist
sl=zeros(25,11);
sl(1,1)=-253;
sl(2,1:2)=[-138 -42];
sl(3,1:3)=[-33 -21 -171];
sl(4,1:4)=[62 -2 -76 -136];
sl(5,1:5)=[147 15 9 -51 -21];
sl(6,1:6)=[222 30 84 24 -6 -78];
sl(7,1:7)=[287 43 149 89 7 -13 -11];
sl(8,1:8)=[342 54 204 144 18 42 0 -36];
sl(9,1:9)=[387 63 249 189 27 87 9 9 -21];
sl(10,1:10)=[432 70 284 224 34 122 16 44 14 -2];
sl(11,1:11)=[447 75 309 249 39 147 21 69 39 3 -3];
sl(12,1:11)=[462 78 324 264 42 162 24 84 54 6 12];
sl(13,1:11)=[467 79 329 269 43 167 25 89 59 7 17];

sl(14:end,:)=flipud(sl(1:12,:));
sl=fliplr(sl);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

